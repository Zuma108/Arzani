<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= blog.seo_title || blog.title %> | Arzani</title>
    <meta name="description" content="<%= blog.meta_description || blog.excerpt %>">
    <meta name="keywords" content="<%= blog.seo_keywords || blog.target_keyword %>">
    
    <!-- Open Graph metadata for social sharing -->
    <meta property="og:title" content="<%= blog.seo_title || blog.title %> | Arzani">
    <meta property="og:description" content="<%= blog.meta_description || blog.excerpt %>">
    <meta property="og:image" content="<%= blog.hero_image %>">
    <meta property="og:url" content="<%= `https://arzani.co.uk/blog/${blog.content_category}/${blog.slug}` %>">
    <meta property="og:type" content="article">
    
    <!-- Twitter Card metadata -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="<%= blog.seo_title || blog.title %> | Arzani">
    <meta name="twitter:description" content="<%= blog.meta_description || blog.excerpt %>">
    <meta name="twitter:image" content="<%= blog.hero_image %>">
    
    <!-- Canonical URL to prevent duplicate content issues -->
    <link rel="canonical" href="<%= `https://arzani.co.uk/blog/${blog.content_category}/${blog.slug}` %>">
    
    <link rel="icon" href="/figma design exports/images.webp/arzani-icon-nobackground.png" type="image/png">
    <link rel="stylesheet" href="/css/modern.css">
    <link rel="stylesheet" href="/css/blog.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#316FD4',
                        'primary-dark': '#2856B3',
                        dark: '#141414',
                        'dark-light': '#1E1E1E',
                        'gray-50': '#F9FAFB',
                        'gray-100': '#F3F4F6',
                        'gray-200': '#E5E7EB',
                        'gray-300': '#D1D5DB',
                        'gray-400': '#9CA3AF',
                        'gray-500': '#6B7280',
                        'gray-600': '#4B5563',
                        'gray-700': '#374151',
                        'gray-800': '#1F2937',
                        'gray-900': '#111827'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', '-apple-system', 'BlinkMacSystemFont', 'sans-serif']
                    },
                    fontSize: {
                        'xs': ['0.75rem', { lineHeight: '1rem' }],
                        'sm': ['0.875rem', { lineHeight: '1.25rem' }],
                        'base': ['1rem', { lineHeight: '1.5rem' }],
                        'lg': ['1.125rem', { lineHeight: '1.75rem' }],
                        'xl': ['1.25rem', { lineHeight: '1.75rem' }],
                        '2xl': ['1.5rem', { lineHeight: '2rem' }],
                        '3xl': ['1.875rem', { lineHeight: '2.25rem' }],
                        '4xl': ['2.25rem', { lineHeight: '2.5rem' }],
                        '5xl': ['3rem', { lineHeight: '1.1' }],
                        '6xl': ['3.75rem', { lineHeight: '1.1' }]
                    },
                    boxShadow: {
                        'soft': '0 2px 8px 0 rgba(0, 0, 0, 0.08)',
                        'medium': '0 4px 16px 0 rgba(0, 0, 0, 0.12)',
                        'large': '0 8px 32px 0 rgba(0, 0, 0, 0.16)'
                    }
                }
            }
        }
    </script>
    
    <!-- Schema.org markup for structured data -->
    <script type="application/ld+json">
        <%- blog.schema_markup %>
    </script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W50GKB6F3M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W50GKB6F3M');
    </script>
    
    <!-- Modern Blog Styles -->
    <style>
        /* Enhanced Modern Navbar */
        .modern-navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.04);
        }
        
        .modern-navbar.scrolled {
            background: rgba(255, 255, 255, 0.98);
            box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.12);
        }
        
        /* Enhanced Navigation Links */
        .nav-link {
            position: relative;
            font-weight: 500;
            color: #374151;
            transition: all 0.2s ease;
            padding: 0.5rem 0;
        }
        
        .nav-link:hover {
            color: #316FD4;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #316FD4, #2856B3);
            transition: width 0.3s ease;
            border-radius: 1px;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Enhanced Reading Progress Bar */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #316FD4, #2856B3);
            width: 0%;
            z-index: 100;
            transition: width 0.1s ease;
        }
        
        /* Modern Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, #316FD4, #2856B3);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.2s ease;
            box-shadow: 0 2px 8px 0 rgba(49, 111, 212, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px 0 rgba(49, 111, 212, 0.4);
            text-decoration: none;
            color: white;
        }
        
        /* Enhanced Prose Styles */
        .prose {
            max-width: none;
            color: #374151;
            line-height: 1.75;
        }
        
        .prose h1 {
            color: #111827;
            font-weight: 800;
            margin-bottom: 1rem;
        }
        
        .prose h2 {
            color: #111827;
            font-weight: 700;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-size: 1.5rem;
            line-height: 1.3;
        }
        
        .prose h3 {
            color: #111827;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            font-size: 1.25rem;
            line-height: 1.4;
        }
        
        .prose p {
            margin-bottom: 1.25rem;
        }
        
        .prose ul, .prose ol {
            margin: 1.25rem 0;
            padding-left: 1.5rem;
        }
        
        .prose li {
            margin-bottom: 0.5rem;
        }
        
        .prose a {
            color: #316FD4;
            text-decoration: underline;
            text-decoration-color: rgba(49, 111, 212, 0.3);
            transition: all 0.2s ease;
        }
        
        .prose a:hover {
            color: #2856B3;
            text-decoration-color: #2856B3;
        }
        
        .prose blockquote {
            border-left: 4px solid #316FD4;
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #4B5563;
        }
        
        /* Table of Contents Enhancement */
        .toc-link {
            display: block;
            padding: 0.5rem 0;
            color: #6B7280;
            text-decoration: none;
            border-left: 2px solid transparent;
            padding-left: 1rem;
            margin-left: -1rem;
            transition: all 0.2s ease;
            font-size: 0.875rem;
            line-height: 1.4;
        }
        
        .toc-link:hover {
            color: #316FD4;
            border-left-color: #316FD4;
            background-color: rgba(49, 111, 212, 0.05);
            text-decoration: none;
        }
        
        .toc-link.toc-h3 {
            padding-left: 2rem;
            margin-left: -1rem;
            font-size: 0.8125rem;
            color: #9CA3AF;
        }
        
        .toc-link.toc-h3:hover {
            color: #316FD4;
        }
        
        /* Enhanced Card Styles */
        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.12);
            transform: translateY(-2px);
        }
        
        /* Author Section Enhancement */
        .author-avatar {
            width: 4rem;
            height: 4rem;
            border-radius: 50%;
            border: 3px solid #F3F4F6;
            box-shadow: 0 4px 16px 0 rgba(0, 0, 0, 0.1);
        }
        
        /* Breadcrumb Enhancement */
        .breadcrumb a {
            color: #6B7280;
            text-decoration: none;
            transition: color 0.2s ease;
        }
        
        .breadcrumb a:hover {
            color: #316FD4;
        }
        
        /* Line Clamp Utilities */
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>
<body class="bg-white text-gray-900 font-sans">
    <!-- Reading Progress Bar -->
    <div class="reading-progress" id="readingProgress"></div>
    
    <!-- Modern Navigation Header -->
    <header class="modern-navbar fixed w-full top-0 z-50" id="navbar">
        <nav class="container mx-auto px-4 lg:px-8 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center">
                    <a href="/" class="flex items-center">
                        <img src="/figma design exports/images/arzani-icon-nobackground.png" alt="Arzani" class="h-8 w-8 mr-3">
                        <span class="text-xl font-bold text-gray-900">Arzani</span>
                    </a>
                </div>
                
                <!-- Navigation Links -->
                <div class="hidden md:flex items-center space-x-8">
                    <a href="/" class="nav-link">Home</a>
                    <a href="/blog" class="nav-link">Blog</a>
                    <a href="/marketplace2" class="nav-link">Marketplace</a>
                    <a href="/business-valuation" class="nav-link">Valuation</a>
                    <a href="/contact" class="nav-link">Contact</a>
                </div>
                
                <!-- CTA Button -->
                <div class="hidden md:flex items-center">
                    <a href="/business-valuation" class="btn-primary">
                        Get Valuated
                    </a>
                </div>
                
                <!-- Mobile Menu Button -->
                <div class="md:hidden">
                    <button class="text-gray-600 hover:text-gray-900 focus:outline-none">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
    </header>
    
    <div class="page-wrapper">
        <!-- Enhanced Blog Post Hero Section -->
        <section class="hero-section pt-24 lg:pt-28 pb-12 lg:pb-20">
            <div class="container mx-auto px-4 md:px-6">
                <div class="flex flex-col lg:flex-row gap-8">
                    <div class="lg:w-2/3">
                        <!-- Breadcrumb Navigation -->
                        <div class="breadcrumb flex items-center text-sm text-gray-500 mb-6">
                            <a href="/blog" class="hover:text-primary transition-colors">Blog</a>
                            <span class="mx-2 text-gray-400">›</span>
                            <a href="/blog/<%= blog.content_category.toLowerCase().replace(/\s+/g, '-') %>" class="hover:text-primary transition-colors">
                                <%= blog.content_category.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ') %>
                            </a>
                            <span class="mx-2 text-gray-400">›</span>
                            <span class="text-gray-600 truncate max-w-xs"><%= blog.title.length > 50 ? blog.title.substring(0, 50) + '...' : blog.title %></span>
                        </div>
                        
                        <!-- Article Header -->
                        <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold mb-6 leading-tight text-gray-900 tracking-tight">
                            <%= blog.title %>
                        </h1>
                        
                        <!-- Author and Date Information -->
                        <div class="flex items-center mb-8">
                            <% 
                            // Create proper author object with Arzani branding
                            const authorData = blog.author || {};
                            const authorName = authorData.name || blog.author_name || 'Arzani Team';
                            const authorBio = authorData.bio || blog.author_bio || 'Expert business marketplace insights from the Arzani team.';
                            const authorAvatar = authorData.avatar || blog.author_image || '/figma design exports/images/arzani-icon-nobackground.png';
                            %>
                            <img src="<%= authorAvatar %>" 
                                alt="<%= authorName %>" 
                                class="author-avatar w-12 h-12 rounded-full mr-4"
                                onerror="this.onerror=null; this.src='/figma design exports/images/arzani-icon-nobackground.png';">
                            <div>
                                <p class="font-semibold text-gray-900 text-lg"><%= authorName %></p>
                                <div class="text-sm text-gray-500 flex items-center">
                                    <span><%= new Date(blog.publish_date || blog.created_at).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' }) %></span>
                                    <span class="mx-2 text-gray-400">•</span>
                                    <span><%= blog.reading_time || blog.read_time || '5' %> min read</span>
                                    <% if (blog.view_count && blog.view_count > 0) { %>
                                    <span class="mx-2 text-gray-400">•</span>
                                    <span><%= blog.view_count %> views</span>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hero Image -->
                        <div class="rounded-xl overflow-hidden mb-8">
                            <img src="<%= blog.hero_image || 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg' %>" 
                                alt="<%= blog.title %>" 
                                class="w-full h-auto object-cover"
                                onerror="this.onerror=null; this.src='https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg';">
                        </div>
                    </div>
                    
                    <!-- Right Sidebar (Table of Contents) -->
                    <div class="lg:w-1/3">
                        <div class="card bg-gray-50 p-6 sticky top-28">
                            <h3 class="text-xl font-bold mb-4 text-gray-900">Table of Contents</h3>
                            <div id="tableOfContents" class="space-y-1">
                                <!-- Dynamically populated by JavaScript -->
                            </div>
                            
                            <!-- Empty state -->
                            <div id="emptyToc" class="hidden text-gray-500 text-sm italic">
                                This article contains detailed sections that will be listed here.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Enhanced Blog Post Content -->
        <section class="content-section py-8 lg:py-12">
            <div class="container mx-auto px-4 md:px-6">
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Main Content -->
                    <div class="lg:w-2/3">
                        <!-- Article Content -->
                        <article class="prose prose-lg max-w-none">
                            <%- blog.content %>
                            
                            <!-- CTA Section -->
                            <% if (blog.cta_text && blog.cta_link) { %>
                            <div class="my-12 p-6 bg-primary bg-opacity-5 rounded-xl border border-primary border-opacity-20">
                                <h3 class="text-2xl font-bold text-gray-900 mb-3">Ready to take the next step?</h3>
                                <p class="mb-6 text-gray-700"><%= blog.cta_text %></p>
                                <a href="<%= blog.cta_link %>" class="btn-primary inline-block">
                                    <%= blog.cta_type === 'marketplace' ? 'Explore Marketplace' : (blog.cta_type === 'valuation' ? 'Get Valuated' : 'Learn More') %>
                                </a>
                            </div>
                            <% } %>
                            
                            <!-- Tags -->
                            <% if (blog.tags && blog.tags.length > 0) { %>
                            <div class="flex flex-wrap gap-2 mt-8 mb-8">
                                <% blog.tags.forEach(tag => { %>
                                <a href="/blog/tag/<%= tag.slug %>" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm text-gray-700 transition-colors">
                                    <%= tag.name %>
                                </a>
                                <% }) %>
                            </div>
                            <% } %>
                            
                            <!-- Author Bio Section -->
                            <div class="mt-16 card p-8 bg-gradient-to-r from-gray-50 to-white">
                                <div class="flex items-start space-x-4">
                                    <img src="<%= authorAvatar %>" 
                                        alt="<%= authorName %>" 
                                        class="author-avatar flex-shrink-0"
                                        onerror="this.onerror=null; this.src='/figma design exports/images/arzani-icon-nobackground.png';">
                                    <div class="flex-1">
                                        <h3 class="text-xl font-bold mb-2 text-gray-900">About <%= authorName %></h3>
                                        <p class="text-gray-700 mb-4 leading-relaxed"><%= authorBio %></p>
                                        <% if (authorName === 'Arzani Team') { %>
                                        <div class="flex items-center text-sm text-gray-600">
                                            <svg class="w-4 h-4 mr-2 text-primary" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                                            </svg>
                                            Expert insights from Arzani's AI-powered business marketplace platform
                                        </div>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </article>
                        
                        <!-- Related Posts Section -->
                        <% if (blog.relatedPosts && blog.relatedPosts.length > 0) { %>
                        <div class="mt-16">
                            <h3 class="text-2xl font-bold mb-6">Related Articles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <% blog.relatedPosts.forEach(relatedPost => { %>
                                <div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden transition-transform hover:shadow-md hover:-translate-y-1">
                                    <a href="/blog/<%= relatedPost.content_category || 'buying-a-business' %>/<%= relatedPost.slug %>">
                                        <img src="<%= relatedPost.hero_image || 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg' %>" 
                                            alt="<%= relatedPost.title %>" 
                                            class="w-full h-48 object-cover"
                                            onerror="this.onerror=null; this.src='https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg';">
                                        <div class="p-4">
                                            <h4 class="text-lg font-bold mb-2 line-clamp-2"><%= relatedPost.title %></h4>
                                            <p class="text-gray-600 text-sm line-clamp-3"><%= relatedPost.excerpt %></p>
                                        </div>
                                    </a>
                                </div>
                                <% }) %>
                            </div>
                        </div>
                        <% } %>
                        
                        <!-- Parent Pillar Content Section -->
                        <% if (blog.parentPillar) { %>
                        <div class="mt-16 p-6 bg-primary bg-opacity-5 rounded-xl">
                            <h3 class="text-2xl font-bold mb-3">Read the Complete Guide</h3>
                            <p class="mb-6">This article is part of our comprehensive guide on <%= blog.parentPillar.title.toLowerCase().includes('guide') ? blog.parentPillar.title.split('guide')[0].trim() : blog.parentPillar.title %>.</p>
                            <a href="/blog/<%= blog.parentPillar.content_category || 'buying-a-business' %>/<%= blog.parentPillar.slug %>" class="btn-primary inline-block">
                                Read Full Guide
                            </a>
                        </div>
                        <% } %>
                    </div>
                    
                    <!-- Right Sidebar for Desktop -->
                    <div class="lg:w-1/3 hidden lg:block">
                        <!-- Categories Widget -->
                        <div class="card p-6 mb-8">
                            <h3 class="text-xl font-bold mb-4 text-gray-900">Explore Categories</h3>
                            <ul class="space-y-3">
                                <% if (categories && categories.length > 0) { %>
                                <% categories.forEach(category => { %>
                                <li>
                                    <a href="/blog/<%= category.slug || category.name.toLowerCase().replace(/\s+/g, '-') %>" 
                                       class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors group">
                                        <span class="text-gray-700 group-hover:text-primary transition-colors font-medium">
                                            <%= category.name || category %>
                                        </span>
                                        <span class="bg-gray-100 group-hover:bg-primary group-hover:text-white px-2 py-1 rounded-full text-xs transition-colors">
                                            <%= category.post_count || '0' %>
                                        </span>
                                    </a>
                                </li>
                                <% }) %>
                                <% } else { %>
                                <li class="text-gray-500 text-sm italic">Categories will appear here</li>
                                <% } %>
                            </ul>
                        </div>
                        
                        <!-- Newsletter Signup -->
                        <div class="card bg-gradient-to-br from-gray-900 to-gray-800 text-white p-6 mb-8">
                            <div class="flex items-center mb-3">
                                <svg class="w-6 h-6 mr-2 text-primary" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                                    <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                                </svg>
                                <h3 class="text-xl font-bold">Get Business Insights</h3>
                            </div>
                            <p class="mb-4 text-gray-300 leading-relaxed">Subscribe to our newsletter for the latest business market insights and AI-powered analysis.</p>
                            <form action="/api/subscribe" method="POST" class="space-y-3">
                                <input type="email" name="email" placeholder="Your email address" required 
                                    class="w-full px-4 py-3 rounded-lg bg-gray-800 border border-gray-700 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors">
                                <button type="submit" class="w-full btn-primary py-3 rounded-lg font-semibold">
                                    Subscribe Now
                                </button>
                            </form>
                        </div>
                        
                        <!-- CTA Widget -->
                        <div class="card p-6 bg-gradient-to-br from-primary to-primary-dark text-white">
                            <div class="flex items-center mb-3">
                                <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zm0 4a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1V8zm8 0a1 1 0 011-1h4a1 1 0 011 1v2a1 1 0 01-1 1h-4a1 1 0 01-1-1V8zm0 4a1 1 0 011-1h4a1 1 0 011 1v2a1 1 0 01-1 1h-4a1 1 0 01-1-1v-2z" clip-rule="evenodd"></path>
                                </svg>
                                <h3 class="text-xl font-bold">Ready to Sell Your Business?</h3>
                            </div>
                            <p class="mb-4 text-blue-100 leading-relaxed">Get an accurate valuation in minutes with our AI-powered tool.</p>
                            <a href="/valuation" class="block w-full bg-white text-primary text-center py-3 px-4 rounded-lg font-semibold hover:bg-gray-50 transition-colors">
                                Get Valuated
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <!-- Simplified Cookie Consent Banner -->
    <div id="cookieConsentBanner" class="fixed bottom-0 left-0 right-0 bg-dark-light p-4 border-t border-gray-700 z-[100] hidden">
        <div class="container mx-auto px-4 md:px-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <p class="text-white text-sm">We use cookies to enhance your experience. By continuing, you agree to our <a href="/privacy-policy" class="underline">Privacy Policy</a>.</p>
            <div class="flex gap-2">
                <button id="acceptCookies" class="bg-primary hover:bg-primary-dark text-white px-4 py-1 rounded text-sm transition-colors">Accept</button>
                <button id="declineCookies" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-1 rounded text-sm transition-colors">Decline</button>
            </div>
        </div>
    </div>

    <script src="/js/navigation.js"></script>
    <script src="/js/blog-post.js"></script>
    <script src="/js/cookie-banner.js"></script>
    
    <script>
        // Enhanced Table of Contents Generator
        document.addEventListener('DOMContentLoaded', function() {
            const article = document.querySelector('article');
            const tableOfContents = document.getElementById('tableOfContents');
            const emptyToc = document.getElementById('emptyToc');
            
            if (article && tableOfContents) {
                // Get all headings (h1, h2, h3) from the article content
                const headings = article.querySelectorAll('h1, h2, h3, h4');
                
                if (headings.length === 0) {
                    if (emptyToc) emptyToc.classList.remove('hidden');
                    return;
                }
                
                // Clear the TOC first
                tableOfContents.innerHTML = '';
                
                // Create TOC entries
                headings.forEach((heading, index) => {
                    // Skip if heading is empty
                    if (!heading.textContent.trim()) return;
                    
                    // Create a unique ID for the heading if it doesn't have one
                    if (!heading.id) {
                        const headingText = heading.textContent.trim()
                            .toLowerCase()
                            .replace(/[^a-z0-9\s-]/g, '')
                            .replace(/\s+/g, '-')
                            .replace(/-+/g, '-')
                            .substring(0, 50);
                        heading.id = `heading-${headingText}-${index}`;
                    }
                    
                    // Create the TOC link
                    const tocItem = document.createElement('a');
                    tocItem.href = `#${heading.id}`;
                    tocItem.classList.add('toc-link');
                    
                    // Add specific styling based on heading level
                    const tagName = heading.tagName.toLowerCase();
                    if (tagName === 'h3' || tagName === 'h4') {
                        tocItem.classList.add('toc-h3');
                    }
                    
                    // Clean up the heading text
                    const headingText = heading.textContent.trim();
                    tocItem.textContent = headingText.length > 60 ? headingText.substring(0, 60) + '...' : headingText;
                    
                    // Add smooth scrolling
                    tocItem.addEventListener('click', function(e) {
                        e.preventDefault();
                        const target = document.getElementById(heading.id);
                        if (target) {
                            const offsetTop = target.offsetTop - 100; // Account for fixed header
                            window.scrollTo({
                                top: offsetTop,
                                behavior: 'smooth'
                            });
                        }
                    });
                    
                    tableOfContents.appendChild(tocItem);
                });
                
                // Hide empty state if we have headings
                if (emptyToc) emptyToc.classList.add('hidden');
            }
            
            // Enhanced Reading Progress Indicator
            const readingProgress = document.getElementById('readingProgress');
            if (readingProgress) {
                function updateProgress() {
                    const windowHeight = window.innerHeight;
                    const documentHeight = document.documentElement.scrollHeight;
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    
                    const scrollPercent = (scrollTop / (documentHeight - windowHeight)) * 100;
                    const clampedPercent = Math.min(Math.max(scrollPercent, 0), 100);
                    
                    readingProgress.style.width = `${clampedPercent}%`;
                }
                
                window.addEventListener('scroll', updateProgress);
                window.addEventListener('resize', updateProgress);
                updateProgress(); // Initial call
            }
            
            // Enhanced Navbar Scroll Effect
            const navbar = document.getElementById('navbar');
            if (navbar) {
                let lastScrollY = window.scrollY;
                
                function updateNavbar() {
                    const currentScrollY = window.scrollY;
                    
                    if (currentScrollY > 50) {
                        navbar.classList.add('scrolled');
                    } else {
                        navbar.classList.remove('scrolled');
                    }
                    
                    lastScrollY = currentScrollY;
                }
                
                window.addEventListener('scroll', updateNavbar);
                updateNavbar(); // Initial call
            }
            
            // Enhanced Image Loading
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                img.addEventListener('load', function() {
                    this.style.opacity = '1';
                });
                
                // Add loading placeholder
                if (!img.complete) {
                    img.style.opacity = '0';
                    img.style.transition = 'opacity 0.3s ease';
                }
            });
        });
    </script>
</body>
</html>
 
