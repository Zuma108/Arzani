<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= blog.title %> | Arzani</title>
    <meta name="description" content="<%= blog.meta_description || blog.excerpt %>">
    <!-- Open Graph metadata for social sharing -->
    <meta property="og:title" content="<%= blog.title %> | Arzani">
    <meta property="og:description" content="<%= blog.meta_description || blog.excerpt %>">
    <meta property="og:image" content="<%= blog.hero_image %>">
    <meta property="og:url" content="<%= `https://arzani.co.uk/blog/${blog.slug}` %>">
    <meta property="og:type" content="article">
    
    <link rel="icon" href="/figma design exports/images.webp/arzani-icon-nobackground.png" type="image/png">
    <link rel="stylesheet" href="/css/modern.css">
    <link rel="stylesheet" href="/css/blog.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#316FD4',
                        dark: '#141414',
                        'dark-light': '#1E1E1E'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W50GKB6F3M"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W50GKB6F3M');
    </script>
    
    <!-- Blog-specific navbar styles -->
    <style>
        /* Force white text in navbar dropdown items regardless of scroll position */
        .navbar__drawer_dropdown .navbar__link,
        .navbar__drawer_dropdown .text-base,
        .navbar__drawer_dropdown .text-xs {
            color: white !important;
        }
        
        /* Style dropdown background for blog pages */
        .navbar__drawer_card {
            background-color: rgba(30, 30, 30, 0.95) !important;
            backdrop-filter: blur(10px);
        }
        
        /* Override any text color in dropdown items */
        .navbar__drawer_dropdown p {
            color: rgba(156, 163, 175, 1) !important;
        }
        
        /* Fix hover state */
        .navbar__drawer_dropdown .navbar__link:hover {
            background-color: rgba(55, 65, 81, 0.5) !important;
        }
        
        /* Ensure the header is dark even at top of page */
        header.blog-header {
            background-color: rgba(20, 20, 20, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(75, 85, 99, 0.3);
        }
    </style>
</head>
<body class="bg-white text-gray-900 font-sans">
    <div class="page-wrapper">
       
        <header class="header-transparent blog-header fixed w-full z-50 transition-all duration-300">
            <nav class="container max-w-[1920px] mx-auto px-4 md:px-6 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center gap-4 md:gap-10">
                        <a href="/" class="navbar__logo">
                            <img src="/figma design exports/logos/white-arzani-logo.svg" alt="Arzani Logo" class="h-6 md:h-8">
                        </a>
                        <div class="hidden md:flex items-center space-x-8">
                            <!-- Products Dropdown -->
                            <div class="navbar__drawer group relative">
                                <div class="navbar__drawer_trigger flex items-center">
                                    <span class="text-sm font-medium">Products</span>
                                    <div class="icon-1x1-xsmall ml-2">
                                        <svg width="20" height="20" fill="none" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="transition-transform duration-200 group-hover:rotate-180">
                                            <path clip-rule="evenodd" d="M15.5303 13.0303C15.2374 13.3232 14.7626 13.3232 14.4697 13.0303L11.7324 10.2931C11.3276 9.8883 11.0555 9.61703 10.8292 9.42491C10.6096 9.23847 10.4829 9.17101 10.3863 9.13961C10.1352 9.05803 9.86478 9.05803 9.61373 9.13961C9.51706 9.17101 9.39038 9.23847 9.17076 9.42491C8.94445 9.61704 8.67236 9.8883 8.26759 10.2931L5.53033 13.0303C5.23744 13.3232 4.76256 13.3232 4.46967 13.0303C4.17678 12.7374 4.17678 12.2626 4.46967 11.9697L7.20693 9.23241L7.22846 9.21088C7.60615 8.83317 7.9214 8.51791 8.2 8.2814C8.49056 8.03473 8.79021 7.82999 9.1502 7.71302C9.70252 7.53356 10.2975 7.53356 10.8498 7.71302C11.2098 7.82999 11.5094 8.03473 11.8 8.2814C12.0786 8.51791 12.3939 8.83318 12.7715 9.21089L12.7931 9.23241L15.5303 11.9697C15.8232 12.2626 15.8232 12.7374 15.5303 13.0303Z" fill="currentColor" fill-rule="evenodd"></path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="navbar__drawer_dropdown invisible group-hover:visible opacity-0 group-hover:opacity-100 absolute top-full left-0 mt-1 transition-all duration-300 ease-in-out">
                                    <div class="navbar__drawer_dropdown__wrapper pt-2">
                                        <div class="navbar__drawer_card rounded-lg shadow-lg border border-gray-800 overflow-hidden p-4 min-w-[240px]">
                                            <!-- Dropdown content -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

        <%- include('../partials/navbar') %>

        <!-- Blog Post Header with Hero Image -->
        <section class="relative pt-28 md:pt-32 pb-10 md:pb-16 bg-primary bg-opacity-5">
            <div class="absolute inset-0 z-0 opacity-5">
                <div class="grid-pattern"></div>
            </div>
            
            <div class="container mx-auto px-4 md:px-6 relative z-10">
                <!-- Breadcrumbs -->
                <div class="mb-8 flex items-center text-sm text-gray-500">
                    <a href="/" class="hover:text-primary transition-colors">Home</a>
                    <span class="mx-2">/</span>
                    <a href="/blog" class="hover:text-primary transition-colors">Blog</a>
                    <span class="mx-2">/</span>
                    <span class="text-gray-900"><%= blog.title %></span>
                </div>
                  <!-- Post Category Tags -->
                <div class="flex flex-wrap gap-2 mb-4">
                    <% if (blog.categories && blog.categories.length > 0) { %>
                        <% blog.categories.forEach(category => { %>
                            <a href="/blog/category/<%= category.slug %>" 
                               class="text-xs px-3 py-1 rounded-full bg-primary bg-opacity-10 text-primary hover:bg-opacity-20 transition-all"
                               aria-label="View more posts in <%= category.name %> category">
                                <%= category.name %>
                            </a>
                        <% }); %>
                    <% } else { %>
                        <span class="text-xs px-3 py-1 rounded-full bg-gray-100 text-gray-500">
                            Uncategorized
                        </span>
                    <% } %>
                </div>
                
                <!-- Post Title -->
                <h1 class="text-3xl sm:text-4xl md:text-5xl font-bold mb-6 leading-tight max-w-4xl text-gray-900">
                    <%= blog.title %>
                </h1>
                
                <!-- Author and Date Info -->
                <div class="flex items-center mb-8">
                    <div class="flex items-center">
                        <img src="<%= blog.author_image || blog.author?.avatar || '/figma design exports/images/default-avatar.png' %>" 
                             alt="<%= blog.author_name || blog.author?.name || 'Arzani Team' %>" 
                             class="w-10 h-10 rounded-full mr-3 border border-gray-200">
                        <div>
                            <p class="font-medium text-gray-900"><%= blog.author_name || blog.author?.name || 'Arzani Team' %></p>
                            <div class="text-sm text-gray-500 flex items-center">
                                <span><%= new Date(blog.publish_date || blog.publishDate || blog.created_at).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' }) %></span>
                                <span class="mx-2">•</span>
                                <span><%= blog.reading_time || blog.readingTime || 5 %> min read</span>
                            </div>
                        </div>
                    </div>
                      <!-- Social Share Links -->
                    <div class="ml-auto flex items-center gap-3">
                        <span class="text-sm text-gray-500 mr-2 hidden sm:block">Share:</span>
                        <a href="https://twitter.com/intent/tweet?url=<%= encodeURIComponent(`https://arzani.co.uk/blog/${blog.slug}`) %>&text=<%= encodeURIComponent(blog.title) %>" 
                           target="_blank" 
                           aria-label="Share on Twitter"
                           class="w-8 h-8 rounded-full flex items-center justify-center bg-gray-100 border border-gray-200 text-gray-500 hover:bg-primary/10 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary focus:bg-primary/10 focus:text-primary active:bg-primary/20 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0 0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
                            </svg>
                        </a>
                        <a href="https://www.linkedin.com/shareArticle?mini=true&url=<%= encodeURIComponent(`https://arzani.co.uk/blog/${blog.slug}`) %>&title=<%= encodeURIComponent(blog.title) %>" 
                           target="_blank" 
                           aria-label="Share on LinkedIn"
                           class="w-8 h-8 rounded-full flex items-center justify-center bg-gray-100 border border-gray-200 text-gray-500 hover:bg-primary/10 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary focus:bg-primary/10 focus:text-primary active:bg-primary/20 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                            </svg>
                        </a>
                        <a href="mailto:?subject=<%= encodeURIComponent(blog.title) %>&body=<%= encodeURIComponent(`Check out this article: https://arzani.co.uk/blog/${blog.slug}`) %>" 
                           aria-label="Share via Email"
                           class="w-8 h-8 rounded-full flex items-center justify-center bg-gray-100 border border-gray-200 text-gray-500 hover:bg-primary/10 hover:text-primary focus:outline-none focus:ring-2 focus:ring-primary focus:bg-primary/10 focus:text-primary active:bg-primary/20 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M.05 3.555A2 2 0 0 1 2 2h12a2 2 0 0 1 1.95 1.555L8 8.414.05 3.555ZM0 4.697v7.104l5.803-3.558L0 4.697ZM6.761 8.83l-6.57 4.027A2 2 0 0 0 2 14h12a2 2 0 0 0 1.808-1.144l-6.57-4.027L8 9.586l-1.239-.757Zm3.436-.586L16 11.801V4.697l-5.803 3.546Z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                  <!-- Hero Image -->
                <div class="w-full flex justify-center mb-12 animate-fade-in-up">
                    <div class="w-full max-w-3xl h-[150px] md:h-[250px] rounded-xl overflow-hidden bg-gray-100">
                        <img src="<%= blog.hero_image || blog.heroImage || 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg' %>" 
                             alt="<%= blog.title %>" 
                             class="blog-hero-image blog-lazy-image w-full h-full object-cover"
                             loading="eager"
                             onerror="this.onerror=null; this.src='https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg'; this.alt='Default hero image';"
                             onload="this.classList.add('loaded')">
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Blog Post Content -->
        <section class="py-12 md:py-16 bg-white">
            <div class="container mx-auto px-4 md:px-6">
                <div class="grid grid-cols-12 gap-8">
                    <!-- Main Content -->
                    <div class="col-span-12 lg:col-span-8">
                        <article class="prose max-w-none blog-content">
                            <!-- Blog content will be rendered here as HTML -->
                            <%- blog.content %>
                              <!-- Tags -->
                            <% if (blog.tags && blog.tags.length > 0) { %>
                                <div class="flex flex-wrap gap-2 mt-12">
                                    <% blog.tags.forEach(tag => { %>
                                        <a href="/blog/tag/<%= tag.slug %>" 
                                           class="text-xs px-3 py-1 rounded-full bg-gray-100 border border-gray-200 text-gray-700 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-primary focus:bg-gray-200 active:bg-gray-300 transition-all"
                                           aria-label="View more posts with tag <%= tag.name %>">
                                            #<%= tag.name %>
                                        </a>
                                    <% }); %>
                                </div>
                            <% } %>
                        </article>
                        
                        <!-- Author Bio -->
                        <div class="mt-12 p-6 bg-gray-100 backdrop-blur-sm border border-gray-200 rounded-xl">
                            <div class="flex items-start">
                                <img src="<%= blog.author_image || blog.author?.avatar || '/figma design exports/images/default-avatar.png' %>" 
                                     alt="<%= blog.author_name || blog.author?.name || 'Arzani Team' %>" 
                                     class="w-16 h-16 rounded-full mr-4 border border-gray-200">
                                <div>
                                    <h3 class="text-xl font-bold mb-2 text-gray-900">About <%= blog.author_name || blog.author?.name || 'Arzani Team' %></h3>
                                    <p class="text-gray-700 mb-4"><%= blog.author_bio || blog.author?.bio || 'Arzani contributor' %></p>
                                    <div class="flex gap-3">
                                        <% if (blog.author?.twitter) { %>
                                            <a href="<%= blog.author.twitter %>" target="_blank" class="text-primary hover:text-primary/80">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                                    <path d="M5.026 15c6.038 0 9.341-5.003 9.341-9.334 0-.14 0-.282-.006-.422A6.685 6.685 0 0 0 16 3.542a6.658 6.658 0 0 1-1.889.518 3.301 3.301 0 0 0 1.447-1.817 6.533 6.533 0 0 1-2.087.793A3.286 3.286 0 0 0 7.875 6.03a9.325 9.325 0 0 1-6.767-3.429 3.289 3.289 0 0 0 1.018 4.382A3.323 3.323 0 0 1 .64 6.575v.045a3.288 3.288 0 0 0 2.632 3.218 3.203 3.203 0  0 1-.865.115 3.23 3.23 0 0 1-.614-.057 3.283 3.283 0 0 0 3.067 2.277A6.588 6.588 0 0 1 .78 13.58a6.32 6.32 0 0 1-.78-.045A9.344 9.344 0 0 0 5.026 15z"/>
                                                </svg>
                                            </a>
                                        <% } %>
                                        <% if (blog.author?.linkedin) { %>
                                            <a href="<%= blog.author.linkedin %>" target="_blank" class="text-primary hover:text-primary/80">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16">
                                                    <path d="M0 1.146C0 .513.526 0 1.175 0h13.65C15.474 0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487 0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837 0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822 0-1.359.54-1.359 1.248 0 .694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869 0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274 0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54 0 0 1 .016-.025V6.169h-2.4c.03.678 0 7.225 0 7.225h2.4z"/>
                                                </svg>
                                            </a>
                                        <% } %>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Call to Action Section -->
                        <div class="mt-12 p-8 bg-primary bg-opacity-5 border border-primary border-opacity-20 rounded-xl text-center">
                            <h3 class="text-2xl font-bold mb-3 text-gray-900">Ready to take your business to the next level?</h3>
                            <p class="text-gray-700 mb-6 max-w-2xl mx-auto">Get a professional valuation of your business and unlock insights to drive growth and maximize value.</p>
                            <a href="/seller-questionnaire" class="btn-primary">Get Started</a>
                        </div>
                        
                        <!-- Related Articles -->
                        <div class="mt-16">
                            <h3 class="text-2xl font-bold mb-8 text-gray-900">Related Articles</h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <% relatedPosts.forEach(post => { %>
                                    <a href="/blog/<%= post.slug %>" class="block group">
                                        <div class="bg-white border border-gray-200 rounded-xl overflow-hidden transition-all group-hover:border-primary/30 shadow-sm hover:shadow">
                                            <div class="h-32 overflow-hidden">
                                                <img src="<%= post.hero_image || post.heroImage || 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg' %>" 
                                                     alt="<%= post.title %>" 
                                                     class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                                                     onerror="this.onerror=null; this.src='https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg';">
                                            </div>
                                            <div class="p-6">
                                                <div class="flex gap-2 mb-3">
                                                    <% if (post.categories && post.categories.slice && post.categories.length > 0) { %>
                                                        <% post.categories.slice(0, 2).forEach(category => { %>
                                                            <span class="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">
                                                                <%= category.name %>
                                                            </span>
                                                        <% }); %>
                                                    <% } else { %>
                                                        <span class="text-xs px-2 py-1 rounded-full bg-primary/10 text-primary">
                                                            Blog
                                                        </span>
                                                    <% } %>
                                                </div>
                                                <h4 class="text-lg font-bold mb-2 line-clamp-2 text-gray-900"><%= post.title %></h4>
                                                <p class="text-gray-600 text-sm mb-4 line-clamp-2"><%= post.excerpt || post.meta_description || '' %></p>
                                                <div class="flex items-center text-xs text-gray-500">
                                                    <span><%= new Date(post.publish_date || post.publishDate || post.created_at).toLocaleDateString('en-GB', { day: 'numeric', month: 'long', year: 'numeric' }) %></span>
                                                    <span class="mx-2">•</span>
                                                    <span><%= post.reading_time || post.readingTime || 5 %> min read</span>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                <% }); %>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sidebar -->
                    <div class="col-span-12 lg:col-span-4">
                        <div class="sticky top-32">                    <!-- Table of Contents -->
                            <div class="bg-white border border-gray-200 rounded-xl p-6 mb-8 shadow-sm" id="tocContainer">
                                <h4 class="text-lg font-bold mb-4 text-gray-900">Table of Contents</h4>
                                <ul class="space-y-2 text-gray-700" id="tableOfContents">
                                    <!-- This will be populated by JavaScript -->
                                </ul>
                                <div id="emptyToc" class="hidden text-gray-500 text-sm italic">
                                    No section headers found in this article.
                                </div>
                            </div>
                            
                            <!-- Newsletter Signup -->
                            <div class="bg-white border border-gray-200 rounded-xl p-6 mb-8 shadow-sm">
                                <h4 class="text-lg font-bold mb-3 text-gray-900">Stay Updated</h4>
                                <p class="text-gray-700 text-sm mb-4">Get the latest business insights and market trends delivered to your inbox.</p>
                                <form action="/subscribe" method="POST" class="space-y-3">
                                    <input type="email" name="email" placeholder="Your email address" required
                                           class="w-full px-4 py-2 bg-white border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent">
                                    <button type="submit" class="w-full btn-primary">Subscribe</button>
                                </form>
                            </div>
                            
                            <!-- Popular Posts -->
                            <div class="bg-white border border-gray-200 rounded-xl p-6 shadow-sm">
                                <h4 class="text-lg font-bold mb-4 text-gray-900">Popular Posts</h4>
                                <div class="space-y-4">
                                    <% popularPosts.forEach(post => { %>
                                        <a href="/blog/<%= post.slug %>" class="flex items-start group">
                                            <div class="w-12 h-12 rounded-lg overflow-hidden flex-shrink-0 mr-3">                                                <img src="<%= post.hero_image || post.heroImage || 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg' %>" 
                                                     alt="<%= post.title %>" 
                                                     class="w-full h-full object-cover blog-lazy-image"
                                                     loading="lazy"
                                                     onload="this.classList.add('loaded')"
                                                     onerror="this.onerror=null; this.src='https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg'; this.alt='Default image for <%= post.title %>';">
                                            </div>
                                            <div>
                                                <h5 class="font-medium group-hover:text-primary transition-colors line-clamp-2 text-gray-900"><%= post.title %></h5>
                                                <div class="flex text-xs text-gray-500 mt-1">
                                                    <span><%= new Date(post.publish_date || post.publishDate || post.created_at).toLocaleDateString('en-GB', { day: 'numeric', month: 'short', year: 'numeric' }) %></span>
                                                </div>
                                            </div>
                                        </a>
                                    <% }); %>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <%- include('../partials/footer') %>
    </div>

    <!-- Simplified Cookie Consent Banner -->
    <div id="cookieConsentBanner" class="fixed bottom-0 left-0 right-0 bg-dark-light p-4 border-t border-gray-700 z-[100] hidden">
        <div class="container mx-auto px-4 md:px-6 flex flex-col md:flex-row items-center justify-between gap-4">
            <p class="text-sm text-gray-300 text-center md:text-left">
                We use essential cookies to make our site work. With your consent, we may also use non-essential cookies to improve user experience and analyze website traffic. By clicking “Accept All,” you agree to our website's cookie use as described in our <a href="/cookies" class="text-primary hover:underline">Cookie Policy</a>.
            </p>
            <div class="flex flex-shrink-0 gap-3">
                <button id="acceptNecessary" class="btn-secondary text-sm px-4 py-2">Accept Necessary</button>
                <button id="acceptAllCookies" class="btn-primary text-sm px-4 py-2">Accept All</button>
            </div>
        </div>
    </div>

    <script src="/js/navigation.js"></script>    <script>
        // Table of Contents Generator and Image Optimization
        document.addEventListener('DOMContentLoaded', function() {
            // Table of Contents Generator
            const article = document.querySelector('article');
            const tableOfContents = document.getElementById('tableOfContents');
            const tocContainer = document.getElementById('tocContainer');
            const emptyToc = document.getElementById('emptyToc');
            
            if (article && tableOfContents) {
                const headings = article.querySelectorAll('h2, h3');
                if (headings.length > 0) {
                    // Create and populate TOC
                    headings.forEach((heading, index) => {
                        // Create an ID if the heading doesn't have one
                        if (!heading.id) {
                            heading.id = `heading-${index}`;
                        }
                        
                        const listItem = document.createElement('li');
                        const link = document.createElement('a');
                        link.href = `#${heading.id}`;
                        link.textContent = heading.textContent;
                        
                        // Add proper classes and indentation for hierarchy
                        if (heading.tagName === 'H3') {
                            link.className = 'pl-4 text-sm text-gray-600 hover:text-primary block py-1 transition-colors';
                            // Add aria label for better accessibility
                            link.setAttribute('aria-label', `Jump to section: ${heading.textContent}`);
                        } else {
                            link.className = 'text-gray-900 hover:text-primary block py-1 transition-colors font-medium';
                            link.setAttribute('aria-label', `Jump to main section: ${heading.textContent}`);
                        }
                        
                        listItem.appendChild(link);
                        tableOfContents.appendChild(listItem);
                        
                        // Add click event for smooth scrolling with keyboard accessibility
                        link.addEventListener('click', function(e) {
                            e.preventDefault();
                            const targetId = this.getAttribute('href').substring(1);
                            const targetElement = document.getElementById(targetId);
                            
                            if (targetElement) {
                                // Check for reduced motion preference
                                const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
                                
                                window.scrollTo({
                                    top: targetElement.offsetTop - 100,
                                    behavior: prefersReducedMotion ? 'auto' : 'smooth'
                                });
                                
                                // Set focus to the heading for better accessibility
                                targetElement.setAttribute('tabindex', '-1');
                                targetElement.focus();
                            }
                        });
                        
                        // Make headings focusable for keyboard navigation
                        heading.setAttribute('tabindex', '0');
                    });
                } else {
                    // Show empty state message
                    tableOfContents.classList.add('hidden');
                    emptyToc.classList.remove('hidden');
                }
            } else if (tocContainer) {
                // Hide entire TOC container if article doesn't exist
                tocContainer.classList.add('hidden');
            }
            
            // Enhanced lazy loading for images inside blog content
            const contentImages = document.querySelectorAll('.prose img');
            contentImages.forEach(img => {
                // Add blog-lazy-image class
                img.classList.add('blog-lazy-image');
                
                // Add max-width and max-height constraints
                img.style.maxWidth = '100%';
                img.style.maxHeight = '400px';
                img.style.margin = '1.5rem auto';
                img.style.display = 'block';
                
                // Add loading="lazy" attribute for native lazy loading
                img.setAttribute('loading', 'lazy');
                
                // Add missing alt text if not present
                if (!img.alt) {
                    img.alt = 'Blog image';
                }
                
                // Add error handling
                img.addEventListener('error', function() {
                    this.src = 'https://arzani-images1.s3.eu-west-2.amazonaws.com/blogs/default-blog-hero.jpg';
                    this.alt = 'Image could not be loaded';
                    this.classList.add('image-error');
                });
                
                // Create an IntersectionObserver for enhanced lazy loading
                const observer = new IntersectionObserver(entries => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            // Add loaded class to fade in the image
                            entry.target.classList.add('loaded');
                            // Stop observing after it's loaded
                            observer.unobserve(entry.target);
                        }
                    });
                }, {
                    rootMargin: '100px' // Start loading when within 100px of viewport
                });
                
                observer.observe(img);
            });
        });
    </script>
    <!-- Include the cookie banner script -->
    <script src="/js/cookie-banner.js"></script>
</body>
</html>