<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
<!-- Inter font for consistent typography -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
  /* AI Assistant Dialog Styling - Based on PRD specs */
  .ai-assistant-dialog {
    width: 512px;
    height: 550px;
    position: fixed;
    bottom: 130px;
    right: 20px;
    background: #ffffff;
    box-shadow: 0 0 40px rgba(0, 0, 0, 0.2);
    border-radius: 8px;
    overflow: hidden;
    z-index: 99999;
    visibility: hidden;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.3s ease, transform 0.3s ease, visibility 0.3s;
  }
  
  /* Animation classes */
  .ai-assistant-dialog.show {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }
  
  /* Header styling */
  .assistant-dialog-header {
    width: 100%;
    height: 40px;
    background: #000AA4;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
  }
  
  .assistant-title {
    display: inline-flex;
    align-items: center;
    gap: 3.58px;
  }
  
  .assistant-title-text {
    color: white;
    font-size: 16px;
    font-family: 'Inter', sans-serif;
    font-weight: 400;
    line-height: 24px;
  }
  
  .header-beta-badge {
    width: 43.25px;
    height: 19.60px;
    border-radius: 3px;
    border: 0.80px solid #E8E8E8;
    display: inline-flex;
    justify-content: center;
    align-items: center;
  }
  
  .header-beta-text {
    color: white;
    font-size: 10px;
    font-weight: 600;
    line-height: 12.10px;
  }
  
  .close-dialog-btn {
    width: 12px;
    height: 16px;
    background: transparent;
    border: none;
    cursor: pointer;
    color: white;
    padding: 0;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  /* Chat container */
  .chat-container {
    width: 100%;
    height: calc(100% - 40px);
    background: white;
    position: relative;
  }
  
  /* Messages scroll area */
  .messages-scroll {
    width: 100%;
    height: 400px;
    padding: 16px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: #c1c1c1 transparent;
  }
  
  .messages-scroll::-webkit-scrollbar {
    width: 6px;
  }
  
  .messages-scroll::-webkit-scrollbar-track {
    background: transparent;
  }
  
  .messages-scroll::-webkit-scrollbar-thumb {
    background-color: #c1c1c1;
    border-radius: 6px;
  }
  
  /* Message styling */
  .system-message {
    width: 100%;
    position: relative;
    padding-left: 40px;
    margin-top: 16px;
  }
  
  .profile-icon {
    width: 32px;
    height: 32px;
    position: absolute;
    left: 0;
    top: 0;
    background: linear-gradient(93deg, #4F8CFF 0%, #010545 100%);
    border-radius: 6px;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  
  .profile-icon img {
    width: 30px;
    height: 22px;
  }
  
  .message-content {
    padding-left: 8px;
  }
  
  .message-text {
    color: black;
    font-size: 14px;
    font-family: 'Inter', sans-serif;
    font-weight: 400;
    line-height: 20px;
  }
  
  .user-message {
    display: flex;
    justify-content: flex-end;
    margin-top: 16px;
  }
  
  .user-message .message-content {
    background: #F8F8F8;
    padding: 10px 16px;
    border-radius: 8px;
    max-width: 80%;
  }
  
  /* Input container */
  .input-container {
    position: absolute;
    bottom: 40px;
    left: 16px;
    width: calc(100% - 32px);
  }
  
  .form-control {
    width: 100%;
    height: 41.6px;
    background: white;
    border-radius: 4px;
    border: 0.8px solid rgba(0, 0, 0, 0.15);
    padding: 8px 40px;
    font-size: 14px;
    font-family: 'Inter', sans-serif;
  }
  
  .paperclip-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #979DA5;
    font-size: 16px;
  }
  
  .send-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #5D2AC6;
    font-size: 16px;
    cursor: pointer;
  }
  
  /* Credits container */
  .credits-container {
    position: absolute;
    bottom: 8px;
    left: 16px;
    width: calc(100% - 32px);
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #3B3B3B;
  }
  
  .credits-star {
    color: #000AA4;
    font-size: 12px;
  }
  
  .credits-bold {
    font-weight: 700;
  }
  
  .credits-upgrade {
    color: #000AA4;
    cursor: pointer;
  }
  
  /* Suggestion chips */
  .suggestion-chips {
    padding: 0 16px 8px;
    margin-top: 10px;
  }
  
  .chips-container {
    display: flex;
    flex-wrap: nowrap;
    gap: 8px;
    overflow-x: auto;
    padding-bottom: 8px;
  }
  
  .suggestion-chip {
    padding: 8px 16px;
    background: #FBFBFB;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    color: #4C5055;
    font-size: 12px;
    cursor: pointer;
  }
  
  .action-tile {
    width: 194px;
    height: 84px;
    background: #FBFBFB;
    border-radius: 4px;
    border: 0.8px solid #ECECEC;
    display: flex;
    padding: 12px;
    margin-top: 16px;
    position: relative;
    cursor: pointer;
  }
  
  .tile-icon {
    width: 17.5px;
    height: 14px;
    color: #FF0000;
    margin-right: 12px;
  }
  
  .tile-content {
    display: flex;
    flex-direction: column;
    gap: 4px;
  }
  
  .tile-title {
    color: black;
    font-size: 14px;
    font-weight: 600;
    line-height: 20px;
  }
  
  .tile-description {
    color: #999999;
    font-size: 14px;
    font-weight: 400;
    line-height: 18px;
  }
  
  .input-container {
    position: absolute;
    bottom: 8px;
    left: 16px;
    width: calc(100% - 32px);
  }
  
  .form-control {
    width: 100%;
    height: 41.6px;
    background: white;
    border-radius: 4px;
    border: 0.8px solid rgba(0, 0, 0, 0.15);
    padding: 8px 40px 8px 40px;
    font-size: 14px;
  }
  
  .paperclip-icon {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #979DA5;
    font-size: 16px;
  }
  
  .send-icon {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #5D2AC6;
    font-size: 16px;
    cursor: pointer;
  }
  
  .credits-container {
    position: absolute;
    bottom: 8px;
    left: 16px;
    width: calc(100% - 32px);
    height: 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 6px;
    font-size: 12px;
    color: #3B3B3B;
  }
  
  .credits-star {
    color: #000AA4;
    font-size: 12px;
  }
  
  .credits-bold {
    font-weight: 700;
  }
  
  .credits-upgrade {
    color: #000AA4;
    cursor: pointer;
  }

  /* Original chatbox styling (hidden by default) */
  .chat-box {
    position: fixed;
    bottom: 130px;  /* Increased from 80px to move up by 50px */
    right: 20px;    /* Changed from left to right */
    width: 320px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    border: 1px solid #e5e5e5;
    display: none;
    z-index: 999;
  }
  
  .chat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background-color: #0009a3;
    color: white;
    padding: 12px;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
  }
  
  .header-title {
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: 500;
  }
  
  .header-title img {
    width: 20px;
    height: 20px;
    object-fit: contain;
  }
  
  .close-button {
    color: white;
    background: none;
    border: none;
    cursor: pointer;
  }
  
  .close-button:hover {
    color: #e5e5e5;
  }
  
  .chat-messages {
    height: 256px;
    overflow-y: auto;
    padding: 12px;
    background-color: #f9f9f9;
  }
  
  .chat-input-container {
    border-top: 1px solid #e5e5e5;
    padding: 12px;
    display: flex;
  }
  
  .chat-input-field {
    flex: 1;
    padding: 8px 12px;
    border: 1px solid #d1d5db;
    border-top-left-radius: 6px;
    border-bottom-left-radius: 6px;
    outline: none;
  }
  
  .chat-input-field:focus {
    border-color: #0009a3;
    box-shadow: 0 0 0 2px rgba(0, 9, 163, 0.2);
  }
  
  .send-button {
    background-color: #0009a3;
    color: white;
    padding: 0 16px;
    border: none;
    border-top-right-radius: 6px;
    border-bottom-right-radius: 6px;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .send-button:hover {
    background-color: #000880;
  }
  
  .hidden {
    display: none;
  }

  /* Responsive adjustments for right positioning */
  @media screen and (max-width: 768px) {
    .assistant-buttons {
      bottom: 65px;  /* Increased from 15px to move up by 50px */
      right: 15px;   /* Changed from left to right */
    }
    
    .chat-box {
      bottom: 120px;  /* Increased from 70px to move up by 50px */
      right: 15px;    /* Changed from left to right */
      width: 280px;
    }

    .ai-assistant-dialog {
      width: 90%;
      right: 5%;
    }
    
    .edited-scenario-banner {
      width: 90%;
    }
  }
  
  @media screen and (max-width: 480px) {
    .assistant-buttons {
      bottom: 60px;  /* Increased from 10px to move up by 50px */
      right: 10px;   /* Changed from left to right */
    }
    
    .chat-box {
      bottom: 110px;  /* Increased from 60px to move up by 50px */
      right: 10px;    /* Changed from left to right */
      width: 90%;
      max-width: 300px;
    }

    .ai-assistant-dialog {
      width: 95%;
      height: 350px;
      right: 2.5%;
    }
  }

  /* Suggestion Chips Styling */
  .suggestion-chip {
    display: inline-flex;
    align-items: center;
    padding: 8px 16px;
    background-color: #f0f0f0;
    border-radius: 16px;
    font-size: 13px;
    color: #333;
    white-space: nowrap;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid #e0e0e0;
  }
  
  .suggestion-chip:hover {
    background-color: #e0e0e0;
    transform: translateY(-1px);
  }
  
  .chips-container::-webkit-scrollbar {
    height: 0;
    width: 0;
    background: transparent;
  }

  /* Lead capture form styling */
  .lead-capture-form {
    padding: 10px 16px;
    background-color: #f5f8ff;
    border-radius: 8px;
    margin: 16px 0;
    border-left: 3px solid #0009a3;
  }
  
  .lead-capture-form label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    font-size: 13px;
  }
  
  .lead-capture-form input {
    width: 100%;
    padding: 8px 12px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 14px;
  }
  
  .lead-capture-form button {
    background-color: #0009a3;
    color: white;
    border: none;
    border-radius: 4px;
    padding: 8px 16px;
    cursor: pointer;
    font-size: 14px;
    transition: background-color 0.2s;
  }
  
  .lead-capture-form button:hover {
    background-color: #000880;
  }
  
  .lead-capture-form .privacy-note {
    font-size: 11px;
    color: #666;
    margin-top: 8px;
  }

  /* Mobile optimizations */
  @media screen and (max-width: 480px) {
    .ai-assistant-dialog {
      width: 100%;
      height: 80vh;
      bottom: 0;
      right: 0;
      border-radius: 16px 16px 0 0;
    }
    
    .assistant-buttons {
      bottom: 16px;
      right: 16px;
    }
    
    .messages-scroll {
      height: calc(100% - 90px);
    }
    
    .input-container {
      position: absolute;
      bottom: 8px;
      width: calc(100% - 32px);
    }
  }

  /* Add a backdrop to ensure dialog is visible */
  .dialog-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.3);
    z-index: 99980; /* Below dialog but above other elements */
    display: none;
  }
  
  .dialog-backdrop.show {
    display: block;
  }
</style>
<div data-layer="div.frame.ng-tns-c168265695-8.ng-trigger.ng-trigger-toggle.ng-star-inserted.overlay" class="DivFrameNgTnsC1682656958NgTriggerNgTriggerToggleNgStarInsertedOverlay" style="width: 512px; height: 649.40px; position: relative; background: rgba(255, 255, 255, 0.01); box-shadow: -10px 0px 40px rgba(0, 0, 0, 0.06); border-radius: 8px; overflow: hidden">
  <div data-layer="div.copilot-header.d-flex.align-items-center.justify-content-between.px-3.ng-tns-c168265695-8" class="DivCopilotHeaderDFlexAlignItemsCenterJustifyContentBetweenPx3NgTnsC1682656958" style="width: 512px; height: 40px; left: 0px; top: 0px; position: absolute; background: #000AA4; justify-content: center; align-items: center; gap: 331.17px; display: inline-flex">
    <div data-layer="span.ng-tns-c168265695-8" class="SpanNgTnsC1682656958" style="width: 136.82px; height: 24px; justify-content: center; align-items: flex-end; gap: 3.58px; display: inline-flex">
      <div data-layer="AI Assistant" class="AiAssistant" style="position: relative; color: white; font-size: 16px; font-family: Inter; font-weight: 400; line-height: 24px; word-wrap: break-word">AI Assistant </div>
      <div data-layer="span.version-badge.ng-tns-c168265695-8.ng-star-inserted" class="SpanVersionBadgeNgTnsC1682656958NgStarInserted" style="width: 43.25px; height: 19.60px; border-radius: 3px; border: 0.80px #E8E8E8 solid; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="BETA" class="Beta" style="position: relative; color: white; font-size: 10px; font-family: Inter; font-weight: 600; line-height: 12.10px; word-wrap: break-word">BETA</div>
      </div>
    </div>
    <div data-layer="i.fa-regular.fa-xmark.ng-tns-c168265695-8" class="IFaRegularFaXmarkNgTnsC1682656958" style="width: 12px; height: 16px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
      <div data-layer="Frame" class="Frame" style="width: 10px; height: 10px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
        <div data-layer="Vector" class="Vector" style="width: 10px; height: 10px; position: relative; background: white"></div>
      </div>
    </div>
  </div>
  <div data-layer="div.chat-container.ng-tns-c3694970646-10" class="DivChatContainerNgTnsC369497064610" style="width: 512px; height: 609.40px; left: 0px; top: 40px; position: absolute; background: white">
    <div data-layer="button.clear-chat-button.mx-auto.ng-tns-c3694970646-10" class="ButtonClearChatButtonMxAutoNgTnsC369497064610" style="width: 97.99px; height: 28.80px; left: 207px; top: 493px; position: absolute; background: white; box-shadow: 0px 6px 16px rgba(217, 202, 255, 0.10); border-radius: 4px; border: 0.80px #E4E4E4 solid; justify-content: center; align-items: flex-start; display: inline-flex">
      <div data-layer="i.fa-regular.fa-trash-can-xmark.ng-tns-c3694970646-10" class="IFaRegularFaTrashCanXmarkNgTnsC369497064610" style="width: 10.50px; height: 12px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="Frame" class="Frame" style="width: 10.50px; height: 12px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
          <div data-layer="Vector" class="Vector" style="width: 10.50px; height: 12px; position: relative; background: black"></div>
        </div>
      </div>
      <div data-layer="Clear chat" class="ClearChat" style="position: relative; color: black; font-size: 12px; font-family: Inter; font-weight: 500; word-wrap: break-word"> Clear chat</div>
    </div>
    <div data-layer="i.fa-regular.fa-paperclip.ng-tns-c663035203-11" class="IFaRegularFaPaperclipNgTnsC66303520311" style="width: 15.75px; height: 18px; left: 24px; top: 543.60px; position: absolute; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
      <div data-layer="Frame" class="Frame" style="width: 15.29px; height: 17.54px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
        <div data-layer="Vector" class="Vector" style="width: 15.29px; height: 17.54px; position: relative; background: #979DA5"></div>
      </div>
    </div>
    <div data-layer="div.dmo-flex.dmo-justify-center.dmo-items-center.dmo-mb-8.credits.dmo-mx-16.ng-tns-c3694970646-10.ng-star-inserted" class="DivDmoFlexDmoJustifyCenterDmoItemsCenterDmoMb8CreditsDmoMx16NgTnsC369497064610NgStarInserted" style="width: 480px; height: 20px; left: 16px; top: 581.40px; position: absolute; justify-content: center; align-items: center; gap: 6px; display: inline-flex">
      <div data-layer="i.fa-regular.fa-circle-star.ng-tns-c3694970646-10" class="IFaRegularFaCircleStarNgTnsC369497064610" style="width: 12px; height: 12px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="Frame" class="Frame" style="width: 12px; height: 12px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
          <div data-layer="Vector" class="Vector" style="width: 12px; height: 12px; position: relative; background: #000AA4"></div>
        </div>
      </div>
      <div data-layer="p" class="P" style="width: 420.54px; height: 20px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
        <div data-layer="Remaining:" class="Remaining" style="position: relative; color: #3B3B3B; font-size: 12px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word">Remaining: </div>
        <div data-layer="30" style="position: relative; color: #3B3B3B; font-size: 12px; font-family: Inter; font-weight: 700; line-height: 20px; word-wrap: break-word">30</div>
        <div data-layer="of" class="Of" style="position: relative; color: #3B3B3B; font-size: 12px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word"> of </div>
        <div data-layer="30" style="position: relative; color: #3B3B3B; font-size: 12px; font-family: Inter; font-weight: 700; line-height: 20px; word-wrap: break-word">30</div>
        <div data-layer="credits. Credits reset every 7 days." class="CreditsCreditsResetEvery7Days" style="position: relative; color: #3B3B3B; font-size: 12px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word"> credits. Credits reset every 7 days. </div>
        <div data-layer="Upgrade for more" class="UpgradeForMore" style="position: relative; color: #000AA4; font-size: 12px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word">Upgrade for more</div>
      </div>
    </div>
  </div>
  <div data-layer="div.messages-scroll.dmo-px-16.ng-tns-c3694970646-10" class="DivMessagesScrollDmoPx16NgTnsC369497064610" style="width: 512px; height: 477px; left: 0px; top: 40px; position: absolute">
    <div data-layer="div.dmo-mt-16.ng-tns-c2665823664-13.ng-trigger.ng-trigger-messageContainerAppear.system-message" class="DivDmoMt16NgTnsC266582366413NgTriggerNgTriggerMessagecontainerappearSystemMessage" style="width: 480px; height: 110px; left: 16px; top: 366px; position: absolute">
      <div data-layer="Welcome Michael Adekoya! I'm here to help you create powerful scenarios and automate your workflows. Whether you need assistance generating a new scenario, crafting content, or exploring example scenarios to get started, I'm ready to assist. How can I help you today?" class="WelcomeMichaelAdekoyaIMHereToHelpYouCreatePowerfulScenariosAndAutomateYourWorkflowsWhetherYouNeedAssistanceGeneratingANewScenarioCraftingContentOrExploringExampleScenariosToGetStartedIMReadyToAssistHowCanIHelpYouToday" style="width: 424px; left: 48px; top: 3.60px; position: absolute; color: black; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word">Welcome Michael Adekoya! I'm here to help you create powerful scenarios and automate your workflows. Whether you need assistance generating a new scenario, crafting content, or exploring example scenarios to get started, I'm ready to assist. How can I help you today?</div>
      <div data-layer="Group 49" class="Group49" style="width: 32px; height: 32px; left: 0px; top: -6px; position: absolute">
        <div data-layer="span.profile-icon.system-icon.ng-tns-c2665823664-7.ng-star-inserted" class="SpanProfileIconSystemIconNgTnsC26658236647NgStarInserted" style="width: 32px; height: 32px; left: 0px; top: 0px; position: absolute; background: linear-gradient(93deg, #4F8CFF 0%, #010545 100%); border-radius: 6px"></div>
        <img data-layer="A-logo-removebg-preview 3" class="ALogoRemovebgPreview3" style="width: 30px; height: 22.11px; left: 2px; top: 4px; position: absolute" src="https://placehold.co/30x22" />
      </div>
    </div>
    <div data-layer="div.dmo-mt-16.ng-tns-c2665823664-12.ng-trigger.ng-trigger-messageContainerAppear.system-message" class="DivDmoMt16NgTnsC266582366412NgTriggerNgTriggerMessagecontainerappearSystemMessage" style="width: 480px; height: 334px; left: 16px; top: 16px; position: absolute">
      <div data-layer="div.message-content.ng-tns-c2665823664-12" class="DivMessageContentNgTnsC266582366412" style="width: 440px; height: 334px; left: 40px; top: 0px; position: absolute; flex-direction: column; justify-content: flex-start; align-items: flex-start; gap: 14.40px; display: inline-flex">
        <div data-layer="Welcome Michael Adekoya! I have noticed you have an error in your scenario. You can ask me to help you to solve." class="WelcomeMichaelAdekoyaIHaveNoticedYouHaveAnErrorInYourScenarioYouCanAskMeToHelpYouToSolve" style="width: 424px; position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 20px; word-wrap: break-word">Welcome Michael Adekoya! I have noticed you have an error in your scenario. You can ask me to help you to solve.</div>
        <div data-layer="div.mt-3.d-flex.flex-wrap.dmo-gap-8.ng-tns-c2665823664-12.ng-star-inserted" class="DivMt3DFlexFlexWrapDmoGap8NgTnsC266582366412NgStarInserted" style="width: 424px; height: 268px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-share-nodes" class="IFaRegularFaShareNodes" style="width: 12.25px; height: 14px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 12.25px; height: 12.25px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 12.25px; height: 12.26px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-puzzle-piece" class="IFaRegularFaPuzzlePiece" style="width: 14px; height: 14px; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 14px; height: 14px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 14px; height: 14px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-circle-question" class="IFaRegularFaCircleQuestion" style="width: 14px; height: 14px; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 14px; height: 14px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 14px; height: 14px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-brackets-curly" class="IFaRegularFaBracketsCurly" style="width: 15.75px; height: 14px; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 15.75px; height: 12.25px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 15.75px; height: 12.26px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-bug-slash" class="IFaRegularFaBugSlash" style="width: 17.50px; height: 14px; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 17.37px; height: 14.01px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 17.50px; height: 14px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
          <div data-layer="button.action-tile" class="ButtonActionTile" style="width: 194px; height: 84px; background: #FBFBFB; border-radius: 4px; border: 0.80px #ECECEC solid; justify-content: flex-start; align-items: center; display: inline-flex">
            <div data-layer="i.fa-regular.fa-share-nodes" class="IFaRegularFaShareNodes" style="width: 12.25px; height: 14px; flex-direction: column; justify-content: center; align-items: center; display: inline-flex">
              <div data-layer="Frame" class="Frame" style="width: 12.25px; height: 12.25px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
                <div data-layer="Vector" class="Vector" style="width: 12.25px; height: 12.26px; position: relative; background: black"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div data-layer="Group 48" class="Group48" style="width: 32px; height: 32px; left: 0px; top: -4px; position: absolute">
        <div data-layer="span.profile-icon.system-icon.ng-tns-c2665823664-7.ng-star-inserted" class="SpanProfileIconSystemIconNgTnsC26658236647NgStarInserted" style="width: 32px; height: 32px; left: 0px; top: 0px; position: absolute; background: linear-gradient(93deg, #4F8CFF 0%, #010545 100%); border-radius: 6px"></div>
        <img data-layer="A-logo-removebg-preview 3" class="ALogoRemovebgPreview3" style="width: 30px; height: 22.11px; left: 2px; top: 4px; position: absolute" src="https://placehold.co/30x22" />
      </div>
      <div data-layer="Group 49" class="Group49" style="width: 32px; height: 32px; left: 0px; top: -4px; position: absolute">
        <div data-layer="span.profile-icon.system-icon.ng-tns-c2665823664-7.ng-star-inserted" class="SpanProfileIconSystemIconNgTnsC26658236647NgStarInserted" style="width: 32px; height: 32px; left: 0px; top: 0px; position: absolute; background: linear-gradient(93deg, #4F8CFF 0%, #010545 100%); border-radius: 6px"></div>
        <img data-layer="A-logo-removebg-preview 3" class="ALogoRemovebgPreview3" style="width: 30px; height: 22.11px; left: 2px; top: 4px; position: absolute" src="https://placehold.co/30x22" />
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 148.15px; height: 60px; left: 93.05px; top: 86px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 4px; display: inline-flex">
      <div data-layer="Build scenario" class="BuildScenario" style="position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Build scenario</div>
      <div data-layer="p" class="P" style="width: 136.15px; height: 36px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="How do I fix this error?" class="HowDoIFixThisError" style="width: 136.15px; position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">How do I fix this error?</div>
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 146.40px; height: 60px; left: 296.80px; top: 86px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 4px; display: inline-flex">
      <div data-layer="Find templates" class="FindTemplates" style="position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Find templates</div>
      <div data-layer="p" class="P" style="width: 134.40px; height: 36px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="What templates are there with [[app]] and [[app]]" class="WhatTemplatesAreThereWithAppAndApp" style="width: 134.40px; position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">What templates are there with [[app]] and [[app]]</div>
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 130.99px; height: 42px; left: 94.80px; top: 187px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 4px; display: inline-flex">
      <div data-layer="Ask anything" class="AskAnything" style="position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Ask anything</div>
      <div data-layer="p" class="P" style="width: 118.99px; height: 18px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="What can you do?" class="WhatCanYouDo" style="position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">What can you do?</div>
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 144.65px; height: 60px; left: 298.55px; top: 178px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 4px; display: inline-flex">
      <div data-layer="Create JSON" class="CreateJson" style="position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Create JSON</div>
      <div data-layer="p" class="P" style="width: 132.65px; height: 36px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="Create a JSON with a list of 5 largest European countries, their population numbers, and capital cities." class="CreateAJsonWithAListOf5LargestEuropeanCountriesTheirPopulationNumbersAndCapitalCities" style="width: 132.65px; position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">Create a JSON with a list of 5 largest European countries, their population numbers, and capital cities.</div>
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 142.90px; height: 60px; left: 98.30px; top: 270px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 4px; display: inline-flex">
      <div data-layer="Help with Error" class="HelpWithError" style="position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Help with Error</div>
      <div data-layer="p" class="P" style="width: 130.90px; height: 36px; justify-content: center; align-items: center; display: inline-flex">
        <div data-layer="Why did I get this error?" class="WhyDidIGetThisError" style="width: 130.90px; position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">Why did I get this error?</div>
      </div>
    </div>
    <div data-layer="div.dmo-text-left.dmo-overflow-hidden.dmo-pl-12" class="DivDmoTextLeftDmoOverflowHiddenDmoPl12" style="width: 148.15px; height: 62px; left: 295.05px; top: 269px; position: absolute; flex-direction: column; justify-content: center; align-items: flex-start; gap: 2.40px; display: inline-flex">
      <div data-layer="Generate HTTP based on CURL" class="GenerateHttpBasedOnCurl" style="width: 136.15px; position: relative; color: black; font-size: 14px; font-family: Inter; font-weight: 600; line-height: 20px; word-wrap: break-word">Generate HTTP based on CURL</div>
      <div data-layer="p" class="P" style="width: 136.15px; height: 18px; justify-content: flex-end; align-items: center; display: inline-flex">
        <div data-layer="Create a custom HTTP request based on the specified CURL: curl -X POST https://jsonplaceholder.typicode.com/users -H "Content-Type: application/json" -d '{ "name": "John Doe", "username": "johndoe", "email": "johndoe@example.com" }'." class="CreateACustomHttpRequestBasedOnTheSpecifiedCurlCurlXPostHttpsJsonplaceholderTypicodeComUsersHContentTypeApplicationJsonDNameJohnDoeUsernameJohndoeEmailJohndoeExampleCom" style="width: 143.14px; height: 18px; position: relative; color: #999999; font-size: 14px; font-family: Inter; font-weight: 400; line-height: 18px; word-wrap: break-word">Create a custom HTTP request based on the specified CURL: curl -X POST https://jsonplaceholder.typicode.com/users -H "Content-Type: application/json" -d '{ "name": "John Doe", "username": "johndoe", "email": "johndoe@example.com" }'.</div>
      </div>
    </div>
  </div>
  <div data-layer="i.fa-regular.fa-paper-plane-top.ng-tns-c663035203-11" class="IFaRegularFaPaperPlaneTopNgTnsC66303520311" style="width: 18px; height: 18px; left: 470px; top: 583.60px; position: absolute; justify-content: center; align-items: center; display: inline-flex">
    <div data-layer="Frame" class="Frame" style="width: 18px; height: 15.75px; position: relative; flex-direction: column; justify-content: flex-start; align-items: flex-start; display: flex">
      <div data-layer="Vector" class="Vector" style="width: 18px; height: 15.75px; position: relative; background: #5D2AC6"></div>
    </div>
  </div>
  <div data-layer="span.form-control.searcher.input.ng-tns-c663035203-11.upload" class="SpanFormControlSearcherInputNgTnsC66303520311Upload" style="width: 480px; height: 41.60px; left: 16px; top: 571.80px; position: absolute; background: white; border-radius: 4px; border: 0.80px rgba(0, 0, 0, 0.15) solid"></div>
</div>
<!-- Replace the JavaScript dialog functionality section with this improved version -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    console.log('Chatbox: DOM loaded, setting up dialog functionality');
    
    // Get elements
    const assistantIcon = document.getElementById('assistant-icon');
    const aiButton = document.querySelector('.ai-button');
    const aiAssistantDialog = document.getElementById('ai-assistant-dialog');
    const closeDialogBtn = document.getElementById('close-dialog-btn');
    const dialogBackdrop = document.getElementById('dialog-backdrop');
    
    console.log('Chatbox elements found:', {
      assistantIcon: !!assistantIcon,
      aiButton: !!aiButton,
      dialog: !!aiAssistantDialog,
      closeBtn: !!closeDialogBtn,
      backdrop: !!dialogBackdrop
    });
    
    // Define more robust show/hide functions with debugging
    function showDialog() {
      console.log('showDialog called');
      
      // First make sure the dialog exists
      if (!aiAssistantDialog) {
        console.error('AI Assistant dialog not found in the DOM');
        return;
      }
      
      console.log('Setting dialog to display block');
      // Force display block first to ensure visibility
      aiAssistantDialog.style.display = 'block';
      aiAssistantDialog.style.visibility = 'visible';
      
      // Ensure backdrop is shown
      if (dialogBackdrop) {
        dialogBackdrop.classList.add('show');
      }
      
      // Add a small timeout before adding animation class
      setTimeout(() => {
        console.log('Adding show class to dialog');
        aiAssistantDialog.classList.add('show');
        
        // Focus the input if it exists
        const input = aiAssistantDialog.querySelector('.form-control');
        if (input) {
          console.log('Focusing input field');
          input.focus();
        } else {
          console.warn('Input field not found');
        }
      }, 50);  // Increase timeout slightly
      
      console.log('Dialog should now be visible');
    }
    
    function hideDialog() {
      console.log('hideDialog called');
      if (!aiAssistantDialog) {
        console.error('AI Assistant dialog not found in the DOM');
        return;
      }
      
      console.log('Removing show class and adding hide class');
      aiAssistantDialog.classList.remove('show');
      aiAssistantDialog.classList.add('hide');
      
      // Hide backdrop
      if (dialogBackdrop) {
        dialogBackdrop.classList.remove('show');
      }
      
      setTimeout(() => {
        console.log('Setting display to none');
        aiAssistantDialog.style.visibility = 'hidden';
        aiAssistantDialog.style.display = 'none';
        aiAssistantDialog.classList.remove('hide');
      }, 300);
    }
    
    // Add event listeners with try/catch for better error handling
    if (assistantIcon) {
      console.log('Adding click event to assistant icon');
      assistantIcon.addEventListener('click', function(e) {
        console.log('Assistant icon clicked');
        e.preventDefault();
        e.stopPropagation();
        showDialog();
      });
    }
    
    if (aiButton) {
      console.log('Adding click event to AI button');
      aiButton.addEventListener('click', function(e) {
        console.log('AI button clicked');
        e.preventDefault();
        e.stopPropagation();
        showDialog();
      });
    }
    
    if (closeDialogBtn) {
      console.log('Adding click event to close button');
      closeDialogBtn.addEventListener('click', function(e) {
        console.log('Close button clicked');
        e.preventDefault();
        hideDialog();
      });
    }
    
    if (dialogBackdrop) {
      console.log('Setting up backdrop click handler');
      dialogBackdrop.onclick = function() {
        console.log('Backdrop clicked');
        hideDialog();
      };
    }
    
    // Close on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && aiAssistantDialog && 
          aiAssistantDialog.style.display === 'block') {
        console.log('Escape key pressed, closing dialog');
        hideDialog();
      }
    });
    
    // Test dialog show function after a short delay
    setTimeout(() => {
      console.log('Testing if dialog works by clicking AI button programmatically');
      if (aiButton) {
        // Uncomment this to auto-show the dialog for testing
        // aiButton.click();
      }
    }, 2000);
  });
</script>

<!-- Modify the script loading section to handle errors better -->
<script>
  console.log('Starting AI Assistant script loading logic');
  
  function loadAIAssistant() {
    if (window.AIAssistant) {
      console.log('AIAssistant class already loaded, not loading script again');
      initializeChipsAndAssistant();
      return;
    }
    
    console.log('Loading AI Assistant script from chatbox.ejs');
    const script = document.createElement('script');
    script.src = '/js/ai-assistant.js';
    
    script.onload = () => {
      console.log('AI Assistant script loaded successfully');
      initializeChipsAndAssistant();
    };
    
    script.onerror = (error) => {
      console.error('Failed to load AI Assistant script:', error);
    };
    
    document.body.appendChild(script);
  }
  
  function initializeChipsAndAssistant() {
    // After loading, show suggestion chips
    showSuggestionChips([
      "Find businesses",
      "How to value a business?",
      "Due diligence checklist",
      "Financing options"
    ]);
    
    // Ensure AI Marketplace Integration is loaded
    if (!window.AIMarketplaceIntegration) {
      console.log('Loading AI Marketplace Integration script');
      const marketplaceScript = document.createElement('script');
      marketplaceScript.src = '/js/ai-marketplace-integration.js';
      
      marketplaceScript.onload = () => {
        console.log('AI Marketplace Integration script loaded successfully');
      };
      
      marketplaceScript.onerror = (error) => {
        console.error('Failed to load AI Marketplace Integration script:', error);
      };
      
      document.body.appendChild(marketplaceScript);
    }
  }
  
  // Start the loading process
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadAIAssistant);
  } else {
    loadAIAssistant();
  }
  
  // Function to show suggestion chips
  function showSuggestionChips(suggestions) {
    console.log('Showing suggestion chips:', suggestions);
    const chipsContainer = document.querySelector('.chips-container');
    if (!chipsContainer) {
      console.error('Chips container not found');
      return;
    }
    
    chipsContainer.innerHTML = '';
    
    suggestions.forEach(suggestion => {
      const chip = document.createElement('div');
      chip.className = 'suggestion-chip';
      chip.textContent = suggestion;
      chip.onclick = () => {
        if (window.aiAssistant) {
          console.log('Chip clicked, sending message:', suggestion);
          window.aiAssistant.sendMessage(suggestion);
          
          // Hide chips after selection
          document.querySelector('.suggestion-chips').style.display = 'none';
        } else {
          console.error('AI Assistant not available for chip click');
        }
      };
      
      chipsContainer.appendChild(chip);
    });
    
    const suggestionChips = document.querySelector('.suggestion-chips');
    if (suggestionChips) {
      suggestionChips.style.display = 'block';
    } else {
      console.error('Suggestion chips container not found');
    }
  }
  
  // Make functions available globally
  window.showSuggestionChips = showSuggestionChips;
</script>

<!-- Add this near the bottom of the JavaScript section -->
<script>
  // ...existing code...
  
  // Function to show lead capture form
  function showLeadCaptureForm() {
    const template = document.getElementById('leadCaptureTemplate');
    if (!template) return;
    
    const formClone = document.importNode(template.content, true);
    
    // Get the messages container
    const messagesContainer = document.querySelector('.messages-scroll');
    if (!messagesContainer) return;
    
    // Create a container div for the form
    const formContainer = document.createElement('div');
    formContainer.style.marginTop = '16px';
    formContainer.appendChild(formClone);
    
    messagesContainer.appendChild(formContainer);
    
    // Add event listener to the submit button
    const submitBtn = formContainer.querySelector('#lead-submit-btn');
    if (submitBtn) {
      submitBtn.addEventListener('click', function() {
        const emailInput = formContainer.querySelector('#lead-email');
        const nameInput = formContainer.querySelector('#lead-name');
        
        if (!emailInput || !emailInput.value) {
          alert('Please enter your email address');
          return;
        }
        
        // If AI Assistant exists, update the lead status
        if (window.aiAssistant) {
          window.aiAssistant.leadStatus.email = emailInput.value;
          if (nameInput && nameInput.value) {
            window.aiAssistant.user.name = nameInput.value;
          }
          
          window.aiAssistant.trackEvent('lead_captured', {
            email: emailInput.value,
            name: nameInput?.value || null
          });
          
          // Add a confirmation message
          window.aiAssistant.addSystemMessage('Thank you! Your contact details have been saved. A representative will reach out to you shortly.');
        }
        
        // Remove the form
        formContainer.remove();
      });
    }
    
    // Scroll to the form
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }
  
  // Function to share a document
  function shareDocument(documentInfo) {
    const template = document.getElementById('documentShareTemplate');
    if (!template) return;
    
    const documentClone = document.importNode(template.content, true);
    
    // Update document info
    const docName = documentClone.querySelector('.document-name');
    const docMeta = documentClone.querySelector('.document-meta');
    
    if (docName) docName.textContent = documentInfo.name || 'Business Document';
    if (docMeta) {
      const fileType = documentInfo.type || 'PDF';
      const fileSize = documentInfo.size ? formatFileSize(documentInfo.size) : '2.1 MB';
      docMeta.textContent = `${fileType} â€¢ ${fileSize}`;
    }
    
    // Add event listeners
    const viewBtn = documentClone.querySelector('.document-view-btn');
    const downloadBtn = documentClone.querySelector('.document-download-btn');
    const shareBtn = documentClone.querySelector('.document-share-btn');
    
    if (viewBtn && documentInfo.url) {
      viewBtn.addEventListener('click', () => {
        window.open(documentInfo.url, '_blank');
      });
    }
    
    if (downloadBtn && documentInfo.url) {
      downloadBtn.addEventListener('click', () => {
        // Create a temporary anchor to download the file
        const a = document.createElement('a');
        a.href = documentInfo.url;
        a.download = documentInfo.name || 'document';
        a.click();
      });
    }
    
    if (shareBtn && documentInfo.url) {
      shareBtn.addEventListener('click', () => {
        // If Web Share API is available
        if (navigator.share) {
          navigator.share({
            title: documentInfo.name || 'Business Document',
            text: 'Check out this business document',
            url: documentInfo.url
          }).catch(err => console.error('Error sharing:', err));
        } else {
          // Fallback - copy link to clipboard
          copyToClipboard(documentInfo.url);
          alert('Link copied to clipboard!');
        }
      });
    }
    
    // Get the messages container
    const messagesContainer = document.querySelector('.messages-scroll');
    if (!messagesContainer) return;
    
    // Add document to the messages
    messagesContainer.appendChild(documentClone);
    
    // Scroll to the document
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }
  
  // Helper function to format file size
  function formatFileSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
  }
  
  // Helper function to copy text to clipboard
  function copyToClipboard(text) {
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed'; // Prevent scrolling to bottom
    document.body.appendChild(textarea);
    textarea.select();
    
    try {
      document.execCommand('copy');
    } catch (err) {
      console.error('Failed to copy text:', err);
    }
    
    document.body.removeChild(textarea);
  }
  
  // Make functions available globally
  window.showLeadCaptureForm = showLeadCaptureForm;
  window.shareDocument = shareDocument;
</script>
